#include "diaoul.h"

// clang-format off
const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {
[_COLEMAK_DH] = LAYOUT_split_3x6_5(
  KC_GRV  , KC_Q , KC_W , KC_F    , KC_P   , KC_B    ,                                              KC_J    , KC_L   , KC_U    , KC_Y   , KC_QUOT , KC_MINS,
  KC_ESC  , HR_A , HR_R , HR_S    , HR_T   , KC_G    ,                                              KC_M    , HR_N   , HR_E    , HR_I   , HR_O    , KC_QUES,
  KC_LPRN , KC_Z , KC_X , KC_C    , KC_D   , KC_V    , OS_LSFT , OS_LSFT ,     OS_RSFT , OS_RSFT  , KC_K    , KC_H   , KC_COMM , KC_DOT , KC_SLSH , KC_RPRN,
                          KC_MUTE , KC_ESC , NUM_TAB , NAV_SPC , OS_LSFT ,     OS_RSFT , SYM_BSPC , SYM_ENT , QK_REP , KC_MUTE                             
),

[_SYMBOLS] = LAYOUT_split_3x6_5(
  KC_EXLM , KC_AMPR , KC_COLN , KC_PLUS , KC_PERC , KC_TILD ,                                             _______ , _______ , _______ , _______ , _______ , _______,
  KC_HASH , KC_CIRC , KC_DLR  , KC_UNDS , KC_EQL  , KC_ASTR ,                                             _______ , KC_RCTL , KC_RSFT , KC_RGUI , KC_RALT , _______,
  KC_AT   , KC_LT   , KC_PIPE , KC_MINS , KC_GT   , KC_SLSH , _______ , _______ ,     _______ , _______ , _______ , _______ , _______ , _______ , _______ , _______,
                                _______ , KC_BSLS , KC_TAB  , KC_SPC  , _______ ,     _______ , _______ , _______ , _______ , _______                              
),

[_NUMPAD] = LAYOUT_split_3x6_5(
  _______ , _______ , _______ , _______ , _______ , _______ ,                                             KC_PERC , KC_7   , KC_8    , KC_9 , KC_COLN  , _______,
  _______ , KC_LALT , KC_LGUI , KC_LSFT , KC_LCTL , _______ ,                                             KC_PLUS , KC_1   , KC_2    , KC_3 , KC_MINUS , _______,
  _______ , _______ , _______ , _______ , _______ , _______ , _______ , _______ ,     _______ , _______ , KC_ASTR , KC_4   , KC_5    , KC_6 , KC_SLSH  , _______,
                                _______ , _______ , _______ , _______ , _______ ,     _______ , _______ , KC_0    , KC_DOT , KC_COMM                            
),

[_NAVIGATION] = LAYOUT_split_3x6_5(
  _______ , _______ , _______ , _______ , _______ , _______ ,                                             _______ , _______ , _______ , _______ , _______ , _______,
  _______ , KC_LALT , KC_LGUI , KC_LSFT , KC_LCTL , _______ ,                                             KC_LEFT , KC_DOWN , KC_UP   , KC_RGHT , _______ , _______,
  _______ , _______ , _______ , _______ , _______ , _______ , _______ , _______ ,     _______ , _______ , KC_HOME , KC_PGDN , KC_PGUP , KC_END  , _______ , _______,
                                _______ , _______ , _______ , _______ , _______ ,     _______ , _______ , _______ , _______ , _______                              
),

[_FUNCTION] = LAYOUT_split_3x6_5(
  _______ , _______ , _______ , _______ , _______ , _______ ,                                             _______ , KC_F7   , KC_F8   , KC_F9 , KC_F10 , _______,
  _______ , KC_LALT , KC_LGUI , KC_LSFT , KC_LCTL , _______ ,                                             _______ , KC_F1   , KC_F2   , KC_F3 , KC_F11 , _______,
  _______ , _______ , _______ , _______ , _______ , _______ , _______ , _______ ,     _______ , _______ , _______ , KC_F4   , KC_F5   , KC_F6 , KC_F12 , _______,
                                _______ , _______ , _______ , _______ , _______ ,     _______ , _______ , _______ , _______ , _______                           
),

[_SYSTEM] = LAYOUT_split_3x6_5(
  _______ , _______ , _______ , _______ , _______ , _______ ,                                             _______ , _______ , _______ , _______ , _______  , _______,
  _______ , _______ , _______ , _______ , _______ , _______ ,                                             RGB_TOG , RGB_SAI , RGB_HUI , RGB_VAI , RGB_MOD  , _______,
  _______ , _______ , _______ , _______ , _______ , _______ , _______ , _______ ,     _______ , _______ , _______ , RGB_SAD , RGB_HUD , RGB_VAD , RGB_RMOD , _______,
                                _______ , _______ , _______ , _______ , _______ ,     _______ , _______ , _______ , _______ , _______                               
)
};
// clang-format on
#ifdef OLED_ENABLE
bool oled_task_user(void) {
    if (is_keyboard_master()) {
        oled_write_P(PSTR("username:      diaoul"), false);
        oled_write_P(PSTR("board:          kyria"), false);
        oled_write_P(PSTR("revision:         1.4"), false);
        render_mod_status_alt_gui(get_mods() | get_oneshot_mods(), 0, 5);
        render_mod_status_shift_ctrl(get_mods() | get_oneshot_mods(), is_caps_word_on(), 5, 5);
        render_layer_state(14, 4);
    } else {
        // clang-format off
        static const char PROGMEM kyria_logo[] = {
            0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,128,128,192,224,240,112,120, 56, 60, 28, 30, 14, 14, 14,  7,  7,  7,  7,  7,  7,  7,  7,  7,  7,  7,  7,  7,  7,  7,  7, 14, 14, 14, 30, 28, 60, 56,120,112,240,224,192,128,128,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
            0,  0,  0,  0,  0,  0,  0,192,224,240,124, 62, 31, 15,  7,  3,  1,128,192,224,240,120, 56, 60, 28, 30, 14, 14,  7,  7,135,231,127, 31,255,255, 31,127,231,135,  7,  7, 14, 14, 30, 28, 60, 56,120,240,224,192,128,  1,  3,  7, 15, 31, 62,124,240,224,192,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
            0,  0,  0,  0,240,252,255, 31,  7,  1,  0,  0,192,240,252,254,255,247,243,177,176, 48, 48, 48, 48, 48, 48, 48,120,254,135,  1,  0,  0,255,255,  0,  0,  1,135,254,120, 48, 48, 48, 48, 48, 48, 48,176,177,243,247,255,254,252,240,192,  0,  0,  1,  7, 31,255,252,240,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
            0,  0,  0,255,255,255,  0,  0,  0,  0,  0,254,255,255,  1,  1,  7, 30,120,225,129,131,131,134,134,140,140,152,152,177,183,254,248,224,255,255,224,248,254,183,177,152,152,140,140,134,134,131,131,129,225,120, 30,  7,  1,  1,255,255,254,  0,  0,  0,  0,  0,255,255,255,  0,  0,  0,  0,255,255,  0,  0,192,192, 48, 48,  0,  0,240,240,  0,  0,  0,  0,  0,  0,240,240,  0,  0,240,240,192,192, 48, 48, 48, 48,192,192,  0,  0, 48, 48,243,243,  0,  0,  0,  0,  0,  0, 48, 48, 48, 48, 48, 48,192,192,  0,  0,  0,  0,  0,
            0,  0,  0,255,255,255,  0,  0,  0,  0,  0,127,255,255,128,128,224,120, 30,135,129,193,193, 97, 97, 49, 49, 25, 25,141,237,127, 31,  7,255,255,  7, 31,127,237,141, 25, 25, 49, 49, 97, 97,193,193,129,135, 30,120,224,128,128,255,255,127,  0,  0,  0,  0,  0,255,255,255,  0,  0,  0,  0, 63, 63,  3,  3, 12, 12, 48, 48,  0,  0,  0,  0, 51, 51, 51, 51, 51, 51, 15, 15,  0,  0, 63, 63,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 48, 48, 63, 63, 48, 48,  0,  0, 12, 12, 51, 51, 51, 51, 51, 51, 63, 63,  0,  0,  0,  0,  0,
            0,  0,  0,  0, 15, 63,255,248,224,128,  0,  0,  3, 15, 63,127,255,239,207,141, 13, 12, 12, 12, 12, 12, 12, 12, 30,127,225,128,  0,  0,255,255,  0,  0,128,225,127, 30, 12, 12, 12, 12, 12, 12, 12, 13,141,207,239,255,127, 63, 15,  3,  0,  0,128,224,248,255, 63, 15,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
            0,  0,  0,  0,  0,  0,  0,  3,  7, 15, 62,124,248,240,224,192,128,  1,  3,  7, 15, 30, 28, 60, 56,120,112,112,224,224,225,231,254,248,255,255,248,254,231,225,224,224,112,112,120, 56, 60, 28, 30, 15,  7,  3,  1,128,192,224,240,248,124, 62, 15,  7,  3,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
            0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  1,  3,  7, 15, 14, 30, 28, 60, 56,120,112,112,112,224,224,224,224,224,224,224,224,224,224,224,224,224,224,224,224,112,112,112,120, 56, 60, 28, 30, 14, 15,  7,  3,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0
        };
        // clang-format on
        oled_write_raw_P(kyria_logo, sizeof(kyria_logo));
    }
    return false;
}
#endif

#ifdef ENCODER_ENABLE
bool encoder_update_user(uint8_t index, bool clockwise) {
    if (index == 0) {
        if (layer_state_is(_SYMBOLS)) {
            // Tab control
            if (clockwise) {
                tap_code(KC_TAB);
            } else {
                tap_code16(S(KC_TAB));
            }
        } else {
            // Page up/Page down
            if (clockwise) {
                tap_code(KC_PGDN);
            } else {
                tap_code(KC_PGUP);
            }
        }
    } else if (index == 1) {
        // Volume control
        if (clockwise) {
            tap_code(KC_VOLD);
        } else {
            tap_code(KC_VOLU);
        }
    }
    return false;
}
#endif
